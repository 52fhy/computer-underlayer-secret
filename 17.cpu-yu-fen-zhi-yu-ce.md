# 17.CPU与分支预测

18世纪流水线的诞生带来了制造技术的变革，人类当今拥有琳琅满目物美价廉的商品和流水线技术的 发明密不可分，**因此当你喝着可乐、吹着空调、坐在特斯拉里拿着智能手机刷这篇文章时需要感谢流 水线技术**。&#x20;

一段有趣的代码&#x20;

有这样一段代码：

```
for (int k = 0; k < 10000; k++){ 
    for (int i = 0; i < arr.size(); i++) {    
        if (arr[i] > 256)         
        sum += arr[i]; 
    }
}
```

这段代码非常简单，给定一个数组，计算所有大于256 的元素之和，重复计算 10000 遍。&#x20;

这段代码本身平淡无奇，但有趣的是：**如果这个数组是有序的，那么这段代码的运行速度会比处理无序数组快将近 10 倍**(不同的机器、CPU架构可能会稍有差异)。&#x20;

可这是为什么呢？这和制造业使用的流水线又有什么关系呢？且听我慢慢道来。

## 流水线技术的诞生

1769年，英国人乔赛亚·韦奇伍德开办了一家陶瓷工厂，这家工厂生产的陶瓷乏善可陈，但其内部的管理方式极具创新性，传统的方法都是由制陶工专人来完成，但韦奇伍德研究后将整个制陶工艺流程分成了**几十道工序**，每一道工序都交给专人完成，这样传统的制陶人不复存在，这便是工业流水线最早的雏形。

## 发扬光大

虽然流水线技术可以说是英国人发明的，但发扬光大的却是美国人，这便是福特与T型车。

![](.gitbook/assets/17\_1.jpg)















